var bannerId = $(".banner-box").attr("bannerId");
var apiWeb = "https://api-warapornsalapao.dosetech.co/api/"
var menuId;
var cookie = Cookies.get('languageId');

if (cookie == null) {
    var lang = $(".btn-lang").html();
    var langChoice = $.trim(lang);
    Cookies.set('languageId', langChoice);
}

var header = {
    "API-KEY": "Wa18aporn190112011601oApiKey!",
    "languageId": 'c=' + Cookies.get('languageId') + '|uic=' + Cookies.get('languageId') +''
}

var banner = new Vue({
    el: "#banner-box",
    data: {
        banner: []
    },
    mounted: function () {
        var ajax = apiWeb + 'bannertype/';
        var self = this;
        $.ajax({
            type: 'GET',
            url: ajax + bannerId,
            headers: header,
            success: function (data) {
                $('.banner-placeholder').remove();
                self.banner = data.detail;
            }
        })
    },
    updated: function () {
        $('.banner:first').removeClass('lazy-bg-img');

        var lazyBgImg = function (el) {
            var lazyBgImgs = $(el).find('.lazy-bg-img');
            lazyBgImgs.each(function (i) {
                var el = $(this);
                if (!el.hasClass('is-lazy-loaded')) {
                    el.addClass('is-lazy-loaded');
                }
            });
        }
        
        var banner = $('.banner-box').slick({
            dots: true,
            arrows: false,
            autoplay: true,
            fade: true,
            speed: 1000
        });

        banner.on('beforeChange', function (event, slick, currentSlide, nextSlide) {
            if (currentSlide !== nextSlide) {
                lazyBgImg($(slick.$slides.get(nextSlide)));
            }
        });
    }
})

$(window).scroll(function () {
    if ($(this).scrollTop() >= 50) {        // If page is scrolled more than 50px
        $('#return-to-top').fadeIn(200);    // Fade in the arrow
    } else {
        $('#return-to-top').fadeOut(200);   // Else fade out the arrow
    }
});

$('#return-to-top').click(function () {      // When arrow is clicked
    $('body,html').animate({
        scrollTop: 0                       // Scroll to top of body
    }, 500);
});

$('.product-menu').click(function () {
    Cookies.set('MenuId', 0);
});

$('.language-dropdown .dropdown-item').click(function () {
    Cookies.set('languageId', $(this).attr('id'));
});